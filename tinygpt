{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "1ec05d73",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2024-07-28T12:02:35.304205Z",
     "iopub.status.busy": "2024-07-28T12:02:35.303337Z",
     "iopub.status.idle": "2024-07-28T12:02:47.461196Z",
     "shell.execute_reply": "2024-07-28T12:02:47.460422Z"
    },
    "papermill": {
     "duration": 12.167324,
     "end_time": "2024-07-28T12:02:47.463657",
     "exception": false,
     "start_time": "2024-07-28T12:02:35.296333",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/conda/lib/python3.10/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.24.3\n",
      "  warnings.warn(f\"A NumPy version >={np_minversion} and <{np_maxversion}\"\n"
     ]
    }
   ],
   "source": [
    "import os\n",
    "import tensorflow as tf\n",
    "from tensorflow.keras.layers import Dense, MultiHeadAttention, Embedding, Add, Dropout, LayerNormalization\n",
    "from tensorflow.keras.optimizers import Adam\n",
    "import numpy as np\n",
    "import bisect\n",
    "import re\n",
    "import math\n",
    "import os"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "b3c63bc7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T12:02:47.477122Z",
     "iopub.status.busy": "2024-07-28T12:02:47.476636Z",
     "iopub.status.idle": "2024-07-28T12:02:47.483662Z",
     "shell.execute_reply": "2024-07-28T12:02:47.482792Z"
    },
    "papermill": {
     "duration": 0.015496,
     "end_time": "2024-07-28T12:02:47.485501",
     "exception": false,
     "start_time": "2024-07-28T12:02:47.470005",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'\\n# My tokenkization\\nfrom nltk.corpus import brown\\n\\nfor file in brown.fileids():\\n    clean_file = re.sub(r\\'/[^\\\\s]+\\', \\' \\', brown.raw(file))\\n    dataset += clean_file + \"\\n\" # Concatenate all the files together\\n\\ndataset = re.sub(r\\'\\\\s+\\', \\' \\', dataset)\\nlen(dataset) # Number of characters\\n'"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\"\"\"\n",
    "# My tokenkization\n",
    "from nltk.corpus import brown\n",
    "\n",
    "for file in brown.fileids():\n",
    "    clean_file = re.sub(r'/[^\\s]+', ' ', brown.raw(file))\n",
    "    dataset += clean_file + \"\\n\" # Concatenate all the files together\n",
    "\n",
    "dataset = re.sub(r'\\s+', ' ', dataset)\n",
    "len(dataset) # Number of characters\n",
    "\"\"\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "0a86ef99",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T12:02:47.498097Z",
     "iopub.status.busy": "2024-07-28T12:02:47.497851Z",
     "iopub.status.idle": "2024-07-28T12:02:48.948449Z",
     "shell.execute_reply": "2024-07-28T12:02:48.947613Z"
    },
    "papermill": {
     "duration": 1.459491,
     "end_time": "2024-07-28T12:02:48.950783",
     "exception": false,
     "start_time": "2024-07-28T12:02:47.491292",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "dataset = \"\"\n",
    "\n",
    "texts = pd.read_csv('/kaggle/input/brown.csv')[\"tokenized_text\"]\n",
    "for text in texts:\n",
    "    dataset += text\n",
    "\n",
    "# Separate the punctuation from the words by a space\n",
    "dataset = re.sub('[^a-zA-Z0-9\\s]+', lambda x: x.group(0)[0] , dataset)    \n",
    "dataset = re.sub(r'\\s+', ' ', dataset)\n",
    "\n",
    "words = dataset.split()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "4e429b23",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T12:02:48.964152Z",
     "iopub.status.busy": "2024-07-28T12:02:48.963857Z",
     "iopub.status.idle": "2024-07-28T12:02:49.068453Z",
     "shell.execute_reply": "2024-07-28T12:02:49.067531Z"
    },
    "papermill": {
     "duration": 0.113883,
     "end_time": "2024-07-28T12:02:49.070713",
     "exception": false,
     "start_time": "2024-07-28T12:02:48.956830",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "61264"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vocab = sorted(set(words))\n",
    "vocab_size = len(vocab) + 2\n",
    "vocab_size"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "f8128076",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T12:02:49.096742Z",
     "iopub.status.busy": "2024-07-28T12:02:49.096433Z",
     "iopub.status.idle": "2024-07-28T12:02:49.560298Z",
     "shell.execute_reply": "2024-07-28T12:02:49.559316Z"
    },
    "papermill": {
     "duration": 0.47327,
     "end_time": "2024-07-28T12:02:49.562361",
     "exception": false,
     "start_time": "2024-07-28T12:02:49.089091",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "(55335, 830)"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sentences = dataset.split(\".\")\n",
    "sentences = [s.split() for s in sentences if len(s.split())>0]\n",
    "max_length = max([len(s) for s in sentences])\n",
    "len(sentences), max_length"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "b9360a46",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T12:02:49.575986Z",
     "iopub.status.busy": "2024-07-28T12:02:49.575688Z",
     "iopub.status.idle": "2024-07-28T12:02:49.605955Z",
     "shell.execute_reply": "2024-07-28T12:02:49.605013Z"
    },
    "papermill": {
     "duration": 0.039346,
     "end_time": "2024-07-28T12:02:49.607991",
     "exception": false,
     "start_time": "2024-07-28T12:02:49.568645",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "19.899629529231046 15.372308871704446 118.66599999999744\n"
     ]
    }
   ],
   "source": [
    "lengths = [len(s) for s in sentences]\n",
    "print(np.mean(lengths), np.std(lengths), np.quantile(lengths, .999))\n",
    "\n",
    "# 1 in 1000 sentences exceed 128 so 128 it is."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "98ccb4fd",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T12:02:49.621388Z",
     "iopub.status.busy": "2024-07-28T12:02:49.621103Z",
     "iopub.status.idle": "2024-07-28T12:02:51.518954Z",
     "shell.execute_reply": "2024-07-28T12:02:51.518192Z"
    },
    "papermill": {
     "duration": 1.907213,
     "end_time": "2024-07-28T12:02:51.521248",
     "exception": false,
     "start_time": "2024-07-28T12:02:49.614035",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "sentence_length = 128 # 2 ** math.ceil(math.log2(max_length)) if we want to\n",
    "# include every sentence. But truncating 1 in 1000 for 8x memory saving seems\n",
    "# obvious.\n",
    "pad_id = 0\n",
    "start_id = 1\n",
    "\n",
    "point = bisect.bisect_left(vocab, '.') + 2\n",
    "dataset = np.zeros((len(sentences),  sentence_length + 1), dtype = np.float32) + pad_id\n",
    "\n",
    "for i, sentence in enumerate(sentences):\n",
    "    dataset[i, :min(len(sentence) + 2, sentence_length + 1)] = np.array([start_id] + [bisect.bisect_left(vocab, word) + 2 for word in sentence][:sentence_length - 1] + [point], dtype = np.float32)\n",
    "\n",
    "vocab = [\"<PAD>\", \"<S>\"] + vocab"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "7ed28b52",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T12:02:51.535067Z",
     "iopub.status.busy": "2024-07-28T12:02:51.534781Z",
     "iopub.status.idle": "2024-07-28T12:02:51.540213Z",
     "shell.execute_reply": "2024-07-28T12:02:51.539407Z"
    },
    "papermill": {
     "duration": 0.014365,
     "end_time": "2024-07-28T12:02:51.542126",
     "exception": false,
     "start_time": "2024-07-28T12:02:51.527761",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class FeedForward(tf.keras.Model):\n",
    "    def __init__(self, emb_dim, units):\n",
    "        super().__init__()\n",
    "        self.dense1 = Dense(units, activation = \"relu\")\n",
    "        self.dense2 = Dense(emb_dim)\n",
    "        \n",
    "    def call(self, x):\n",
    "        x = self.dense1(x)\n",
    "        out = self.dense2(x)\n",
    "        return out"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "675f61b0",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T12:02:51.555682Z",
     "iopub.status.busy": "2024-07-28T12:02:51.555005Z",
     "iopub.status.idle": "2024-07-28T12:02:51.562308Z",
     "shell.execute_reply": "2024-07-28T12:02:51.561543Z"
    },
    "papermill": {
     "duration": 0.016056,
     "end_time": "2024-07-28T12:02:51.564219",
     "exception": false,
     "start_time": "2024-07-28T12:02:51.548163",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class Decoder(tf.keras.Model):\n",
    "    def __init__(self, n_heads = 8, emb_dim = 512, units = 2048, dropout = .1):\n",
    "        super().__init__()\n",
    "        self.mha = MultiHeadAttention(n_heads, emb_dim//n_heads)\n",
    "        self.dropout1 =  Dropout(dropout)\n",
    "        self.ln1 = LayerNormalization()\n",
    "        \n",
    "        self.ffn = FeedForward(emb_dim, units)\n",
    "        self.dropout2 =  Dropout(dropout)\n",
    "        self.ln2 = LayerNormalization()\n",
    "        \n",
    "    def call(self, x, training):\n",
    "        # Masked multi-head self-attention\n",
    "        # The mask for the padding is problematic to implement here and it's more \n",
    "        # convenient to mask the loss function and we just use the look-ahead mask here.\n",
    "        x1 = self.mha(x, x, x, use_causal_mask = True)\n",
    "        x1 = self.dropout1(x1, training = training)\n",
    "        x = self.ln1(x1 + x)\n",
    "        \n",
    "        x2 = self.ffn(x)\n",
    "        x2 = self.dropout2(x2, training = training)\n",
    "        x = self.ln2(x + x2)\n",
    "        \n",
    "        return x"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "d212846b",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T12:02:51.577514Z",
     "iopub.status.busy": "2024-07-28T12:02:51.577231Z",
     "iopub.status.idle": "2024-07-28T12:02:51.584218Z",
     "shell.execute_reply": "2024-07-28T12:02:51.583417Z"
    },
    "papermill": {
     "duration": 0.015771,
     "end_time": "2024-07-28T12:02:51.586244",
     "exception": false,
     "start_time": "2024-07-28T12:02:51.570473",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class Transformer(tf.keras.Model):\n",
    "    def __init__(self, vocab_size, sentence_length = 256, n = 6, n_heads = 8, emb_dim = 512, units = 2048, dropout = .1):\n",
    "        super().__init__()\n",
    "        # Embedding layer\n",
    "        self.embedding = Embedding(vocab_size, emb_dim, input_length = sentence_length)\n",
    "        # Positional encoding\n",
    "        self.pos_encode = Add()\n",
    "        self.decoder_stack = [Decoder(n_heads, emb_dim, units, dropout) for _ in range(n)]\n",
    "        self.linear = Dense(vocab_size, activation = tf.nn.log_softmax)\n",
    "        \n",
    "    def call(self, x, training):\n",
    "        \n",
    "        x = self.embedding(x)\n",
    "        x = self.pos_encode([x, pos_encoding])\n",
    "        \n",
    "        for decoder in self.decoder_stack:\n",
    "            x = decoder(x, training)\n",
    "        \n",
    "        out = self.linear(x)\n",
    "        \n",
    "        return out"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "30bb269d",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T12:02:51.599460Z",
     "iopub.status.busy": "2024-07-28T12:02:51.599034Z",
     "iopub.status.idle": "2024-07-28T12:02:51.605114Z",
     "shell.execute_reply": "2024-07-28T12:02:51.604257Z"
    },
    "papermill": {
     "duration": 0.014685,
     "end_time": "2024-07-28T12:02:51.607011",
     "exception": false,
     "start_time": "2024-07-28T12:02:51.592326",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# For a generative model, label smoothing simply hurts perplexity which is what we care \n",
    "# about most. \n",
    "# epsilon = 0.0 maybe better\n",
    "\n",
    "def masked_loss(label, pred, pad_id = 0, epsilon = 0.1): \n",
    "    mask = label != pad_id\n",
    "    \n",
    "    y = tf.one_hot(tf.cast(label, tf.int32), vocab_size, axis = -1)\n",
    "    loss_object = tf.keras.losses.CategoricalCrossentropy(\n",
    "    from_logits=True, reduction='none', label_smoothing = epsilon)\n",
    "    loss = loss_object(y, pred)\n",
    "    \n",
    "    mask = tf.cast(mask, dtype=loss.dtype)\n",
    "    loss *= mask\n",
    "\n",
    "    loss = tf.reduce_sum(loss)/tf.reduce_sum(mask)\n",
    "    return loss"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "8b28cb68",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T12:02:51.620491Z",
     "iopub.status.busy": "2024-07-28T12:02:51.619842Z",
     "iopub.status.idle": "2024-07-28T12:02:51.625749Z",
     "shell.execute_reply": "2024-07-28T12:02:51.624951Z"
    },
    "papermill": {
     "duration": 0.014579,
     "end_time": "2024-07-28T12:02:51.627621",
     "exception": false,
     "start_time": "2024-07-28T12:02:51.613042",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class TransformerLearningRateSchedule(tf.keras.optimizers.schedules.LearningRateSchedule):\n",
    "    def __init__(self, initial_learning_rate, warmup_steps):\n",
    "        self.initial_learning_rate = initial_learning_rate\n",
    "        self.warmup_steps = warmup_steps\n",
    "\n",
    "    def __call__(self, step):\n",
    "        x1 = tf.math.pow(10 / tf.math.sqrt(tf.cast(step, tf.float32)), tf.constant([-0.5]))\n",
    "        x2 =  tf.cast(step, tf.float32) * tf.constant([10 * warmup_steps**-1.5])\n",
    "        return self.initial_learning_rate * tf.math.minimum(x1, x2)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "043fff05",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T12:02:51.641709Z",
     "iopub.status.busy": "2024-07-28T12:02:51.641445Z",
     "iopub.status.idle": "2024-07-28T12:02:52.518029Z",
     "shell.execute_reply": "2024-07-28T12:02:52.517045Z"
    },
    "papermill": {
     "duration": 0.885729,
     "end_time": "2024-07-28T12:02:52.520184",
     "exception": false,
     "start_time": "2024-07-28T12:02:51.634455",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "emb_dim = 512\n",
    "n_heads = 8\n",
    "units = 2048\n",
    "n = 6\n",
    "dropout = 0.1\n",
    "warmup_steps = 500\n",
    "learning_rate = 1e-3\n",
    "# Using a different learning rate than the paper as they train for many more steps.\n",
    "learning_rate_schedule = TransformerLearningRateSchedule(emb_dim**-.5, warmup_steps)\n",
    "optimizer = Adam(learning_rate_schedule, beta_1 = .9, beta_2 = .998, epsilon = 1e-9)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "424ef66a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T12:02:52.534254Z",
     "iopub.status.busy": "2024-07-28T12:02:52.533957Z",
     "iopub.status.idle": "2024-07-28T12:02:52.545031Z",
     "shell.execute_reply": "2024-07-28T12:02:52.544316Z"
    },
    "papermill": {
     "duration": 0.020247,
     "end_time": "2024-07-28T12:02:52.546835",
     "exception": false,
     "start_time": "2024-07-28T12:02:52.526588",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Positional encoding\n",
    "pos_encoding = np.zeros((sentence_length, emb_dim))\n",
    "pos = np.arange(sentence_length)[:, np.newaxis]\n",
    "even = np.arange(emb_dim, step = 2)[np.newaxis, :]\n",
    "pos_encoding[:, ::2] = np.sin(pos/10**(4*even/emb_dim))\n",
    "pos_encoding[:, 1::2] = np.cos(pos/10**(4*even/emb_dim))\n",
    "pos_encoding = pos_encoding[np.newaxis, :, :] # Adding the batch dimension\n",
    "pos_encoding = tf.cast(pos_encoding, dtype=tf.float32)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "7d3888b1",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T12:02:52.559897Z",
     "iopub.status.busy": "2024-07-28T12:02:52.559626Z",
     "iopub.status.idle": "2024-07-28T12:02:53.665294Z",
     "shell.execute_reply": "2024-07-28T12:02:53.664453Z"
    },
    "papermill": {
     "duration": 1.114946,
     "end_time": "2024-07-28T12:02:53.667743",
     "exception": false,
     "start_time": "2024-07-28T12:02:52.552797",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model: \"transformer\"\n",
      "_________________________________________________________________\n",
      " Layer (type)                Output Shape              Param #   \n",
      "=================================================================\n",
      " embedding (Embedding)       multiple                  31367168  \n",
      "                                                                 \n",
      " add (Add)                   multiple                  0         \n",
      "                                                                 \n",
      " decoder (Decoder)           multiple                  3152384   \n",
      "                                                                 \n",
      " decoder_1 (Decoder)         multiple                  3152384   \n",
      "                                                                 \n",
      " decoder_2 (Decoder)         multiple                  3152384   \n",
      "                                                                 \n",
      " decoder_3 (Decoder)         multiple                  3152384   \n",
      "                                                                 \n",
      " decoder_4 (Decoder)         multiple                  3152384   \n",
      "                                                                 \n",
      " decoder_5 (Decoder)         multiple                  3152384   \n",
      "                                                                 \n",
      " dense_12 (Dense)            multiple                  31428432  \n",
      "                                                                 \n",
      "=================================================================\n",
      "Total params: 81709904 (311.70 MB)\n",
      "Trainable params: 81709904 (311.70 MB)\n",
      "Non-trainable params: 0 (0.00 Byte)\n",
      "_________________________________________________________________\n"
     ]
    }
   ],
   "source": [
    "model = Transformer(vocab_size, sentence_length, n, n_heads, emb_dim, units, dropout)\n",
    "model.compile(optimizer, masked_loss)\n",
    "model.build((None, sentence_length))\n",
    "\n",
    "model.summary()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "f4411497",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T12:02:53.685654Z",
     "iopub.status.busy": "2024-07-28T12:02:53.684997Z",
     "iopub.status.idle": "2024-07-28T13:30:40.125333Z",
     "shell.execute_reply": "2024-07-28T13:30:40.124351Z"
    },
    "papermill": {
     "duration": 5267.779352,
     "end_time": "2024-07-28T13:30:41.455397",
     "exception": false,
     "start_time": "2024-07-28T12:02:53.676045",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/10\n",
      "1643/1643 [==============================] - 542s 318ms/step - loss: 7.9207 - val_loss: 7.9655\n",
      "Epoch 2/10\n",
      "1643/1643 [==============================] - 523s 318ms/step - loss: 14.9963 - val_loss: 8.0162\n",
      "Epoch 3/10\n",
      "1643/1643 [==============================] - 525s 319ms/step - loss: 63.1838 - val_loss: 81.3792\n",
      "Epoch 4/10\n",
      "1643/1643 [==============================] - 526s 320ms/step - loss: 91.7572 - val_loss: 86.7375\n",
      "Epoch 5/10\n",
      "1643/1643 [==============================] - 525s 320ms/step - loss: 145.8544 - val_loss: 215.2354\n",
      "Epoch 6/10\n",
      "1643/1643 [==============================] - 525s 320ms/step - loss: 200.2718 - val_loss: 196.3005\n",
      "Epoch 7/10\n",
      "1643/1643 [==============================] - 525s 320ms/step - loss: 241.8018 - val_loss: 293.8884\n",
      "Epoch 8/10\n",
      "1643/1643 [==============================] - 525s 320ms/step - loss: 295.9673 - val_loss: 300.2769\n",
      "Epoch 9/10\n",
      "1643/1643 [==============================] - 525s 320ms/step - loss: 344.1374 - val_loss: 313.8502\n",
      "Epoch 10/10\n",
      "1643/1643 [==============================] - 525s 320ms/step - loss: 388.8161 - val_loss: 378.3717\n"
     ]
    }
   ],
   "source": [
    "batch_size = 32\n",
    "epochs = 10\n",
    "\n",
    "# X is simply the expected output shifted to the right with a <S> token at the beginning.\n",
    "history = model.fit(dataset[:, :-1], dataset[:, 1:], batch_size, epochs, validation_split = .05)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "3440d828",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T13:30:44.247760Z",
     "iopub.status.busy": "2024-07-28T13:30:44.247321Z",
     "iopub.status.idle": "2024-07-28T13:30:44.640522Z",
     "shell.execute_reply": "2024-07-28T13:30:44.639567Z"
    },
    "papermill": {
     "duration": 1.743489,
     "end_time": "2024-07-28T13:30:44.642529",
     "exception": false,
     "start_time": "2024-07-28T13:30:42.899040",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/png": "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iJRKCnZFICTQl5NGEC5Wi+NjsTp+ulhwsVpxtVqwWixYLpk/9TK3Ti9ZdLk+19jPZedpvd4+Fmj0ADTtf5ntREREpCgo2BWBkJpNsL94oHCfcRMREZFST8GuCFgsln88/yYiIiJSOErMa4sffPABVatWxdPTk8jISNasWWN2SSIiIiJFqkQEu6+++orRo0fz4osvsmHDBho1akT79u2Ji3PmtwxEREREClaJCHbvvPMOQ4YMYdCgQURERDB58mS8vb355JNPzC5NREREpMgU+2CXkZHB+vXradu2bfYyq9VK27ZtWblypYmViYiIiBStYv/yxOnTp7HZbISEhORYHhISwq5duy67TXp6Ounp6dnfExMTAUhKSrpsfxERERGzXMwnxuUmCPiXYh/s8mPcuHG8/PLLlywPDw83oRoRERGRa0tOTiYgIOCqfYp9sCtXrhwuLi7ExsbmWB4bG0toaOhltxkzZgyjR/89Qb3dbic+Pp6yZcteZpDggpGUlER4eDhHjx7F39+/UI4hhUd/fsWb/vyKN/35FW/687t+hmGQnJxMWFjYNfsW+2Dn7u5Os2bNWLp0Kffeey/gCGpLly5lxIgRl93Gw8MDDw+PHMsCAwMLuVIHf39//YtdjOnPr3jTn1/xpj+/4k1/ftfnWlfqLir2wQ5g9OjRDBgwgObNm9OyZUsmTJhAamoqgwYNMrs0ERERkSJTIoLdAw88wKlTp3jhhReIiYmhcePGLFq06JIXKkRERERKshIR7ABGjBhxxVuvzsDDw4MXX3zxklvAUjzoz694059f8aY/v+JNf35Fy2Lk5t1ZEREREXF6xX6AYhERERFxULATERERKSEU7ERERERKCAW7IvDBBx9QtWpVPD09iYyMZM2aNWaXJLkwbtw4WrRogZ+fH8HBwdx7773s3r3b7LIkn9544w0sFgsjR440uxTJpePHj9O3b1/Kli2Ll5cXDRo0YN26dWaXJblgs9l4/vnnqVatGl5eXtSoUYNXX301V1NiyfVRsCtkX331FaNHj+bFF19kw4YNNGrUiPbt2xMXF2d2aXINy5YtIzo6mlWrVrF48WIyMzNp164dqampZpcmebR27Vo++ugjGjZsaHYpkktnz56ldevWuLm5sXDhQnbs2MH//vc/ypQpY3ZpkgtvvvkmkyZNYuLEiezcuZM333yTt956i/fff9/s0ko8vRVbyCIjI2nRogUTJ04EHLNihIeH8+ijj/LMM8+YXJ3kxalTpwgODmbZsmXccsstZpcjuZSSkkLTpk358MMPee2112jcuDETJkwwuyy5hmeeeYYVK1bwxx9/mF2K5MNdd91FSEgI06ZNy17WvXt3vLy8+Pzzz02srOTTFbtClJGRwfr162nbtm32MqvVStu2bVm5cqWJlUl+JCYmAhAUFGRyJZIX0dHRdO7cOcd/h+L8vv/+e5o3b859991HcHAwTZo04eOPPza7LMmlG2+8kaVLl7Jnzx4ANm/ezJ9//knHjh1NrqzkKzEDFDuj06dPY7PZLpkBIyQkhF27dplUleSH3W5n5MiRtG7dmvr165tdjuTSl19+yYYNG1i7dq3ZpUgeHThwgEmTJjF69Gj+7//+j7Vr1/LYY4/h7u7OgAEDzC5PruGZZ54hKSmJOnXq4OLigs1mY+zYsfTp08fs0ko8BTuRXIiOjmbbtm38+eefZpciuXT06FH+85//sHjxYjw9Pc0uR/LIbrfTvHlzXn/9dQCaNGnCtm3bmDx5soJdMTBnzhxmzZrF7NmzqVevHps2bWLkyJGEhYXpz6+QKdgVonLlyuHi4kJsbGyO5bGxsYSGhppUleTViBEjWLBgAcuXL6dSpUpmlyO5tH79euLi4mjatGn2MpvNxvLly5k4cSLp6em4uLiYWKFcTYUKFYiIiMixrG7dunz99dcmVSR58eSTT/LMM8/Qs2dPABo0aMDhw4cZN26cgl0h0zN2hcjd3Z1mzZqxdOnS7GV2u52lS5cSFRVlYmWSG4ZhMGLECObPn8+vv/5KtWrVzC5J8qBNmzZs3bqVTZs2ZX+aN29Onz592LRpk0Kdk2vduvUlwwvt2bOHKlWqmFSR5MW5c+ewWnNGDBcXF+x2u0kVlR66YlfIRo8ezYABA2jevDktW7ZkwoQJpKamMmjQILNLk2uIjo5m9uzZfPfdd/j5+RETEwNAQEAAXl5eJlcn1+Ln53fJ85A+Pj6ULVtWz0kWA6NGjeLGG2/k9ddf5/7772fNmjVMmTKFKVOmmF2a5EKXLl0YO3YslStXpl69emzcuJF33nmHBx980OzSSjwNd1IEJk6cyNtvv01MTAyNGzfmvffeIzIy0uyy5BosFstll0+fPp2BAwcWbTFSIG677TYNd1KMLFiwgDFjxrB3716qVavG6NGjGTJkiNllSS4kJyfz/PPPM3/+fOLi4ggLC6NXr1688MILuLu7m11eiaZgJyIiIlJC6Bk7ERERkRJCwU5ERESkhFCwExERESkhFOxERERESggFOxEREZESQsFOREREpIRQsBMREREpIRTsREREREoIBTsRESdhsVj49ttvzS5DRIoxBTsREWDgwIFYLJZLPh06dDC7NBGRXHM1uwAREWfRoUMHpk+fnmOZh4eHSdWIiOSdrtiJiFzg4eFBaGhojk+ZMmUAx23SSZMm0bFjR7y8vKhevTrz5s3Lsf3WrVu544478PLyomzZsgwdOpSUlJQcfT755BPq1auHh4cHFSpUYMSIETnWnz59mq5du+Lt7U2tWrX4/vvvC/ekRaREUbATEcml559/nu7du7N582b69OlDz5492blzJwCpqam0b9+eMmXKsHbtWubOncuSJUtyBLdJkyYRHR3N0KFD2bp1K99//z01a9bMcYyXX36Z+++/ny1bttCpUyf69OlDfHx8kZ6niBRjhoiIGAMGDDBcXFwMHx+fHJ+xY8cahmEYgDFs2LAc20RGRhrDhw83DMMwpkyZYpQpU8ZISUnJXv/jjz8aVqvViImJMQzDMMLCwoxnn332ijUAxnPPPZf9PSUlxQCMhQsXFth5ikjJpmfsREQuuP3225k0aVKOZUFBQdntqKioHOuioqLYtGkTADt37qRRo0b4+Phkr2/dujV2u53du3djsVg4ceIEbdq0uWoNDRs2zG77+Pjg7+9PXFxcfk9JREoZBTsRkQt8fHwuuTVaULy8vHLVz83NLcd3i8WC3W4vjJJEpATSM3YiIrm0atWqS77XrVsXgLp167J582ZSU1Oz169YsQKr1Urt2rXx8/OjatWqLF26tEhrFpHSRVfsREQuSE9PJyYmJscyV1dXypUrB8DcuXNp3rw5N910E7NmzWLNmjVMmzYNgD59+vDiiy8yYMAAXnrpJU6dOsWjjz5Kv379CAkJAeCll15i2LBhBAcH07FjR5KTk1mxYgWPPvpo0Z6oiJRYCnYiIhcsWrSIChUq5FhWu3Ztdu3aBTjeWP3yyy955JFHqFChAl988QUREREAeHt78/PPP/Of//yHFi1a4O3tTffu3XnnnXey9zVgwADS0tIYP348TzzxBOXKlaNHjx5Fd4IiUuJZDMMwzC5CRMTZWSwW5s+fz7333mt2KSIiV6Rn7ERERERKCAU7ERERkRJCz9iJiOSCnloRkeJAV+xERERESggFOxEREZESQsFOREREpIRQsBMREREpIRTsREREREoIBTsRERGREkLBTkRERKSEULATERERKSEU7ERERERKiP8H3CN7BRhbHf4AAAAASUVORK5CYII=",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "# Plot training & validation loss values\n",
    "plt.plot(history.history['loss'], label='Train Loss')\n",
    "plt.plot(history.history['val_loss'], label='Val Loss')\n",
    "plt.title('Model Loss')\n",
    "plt.xlabel('Epoch')\n",
    "plt.ylabel('Loss')\n",
    "plt.ylim(0, max(history.history['loss'] + history.history['val_loss']))\n",
    "\n",
    "plt.tight_layout()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "cf2ff79a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T13:30:47.425093Z",
     "iopub.status.busy": "2024-07-28T13:30:47.424721Z",
     "iopub.status.idle": "2024-07-28T13:30:47.612828Z",
     "shell.execute_reply": "2024-07-28T13:30:47.611879Z"
    },
    "papermill": {
     "duration": 1.554485,
     "end_time": "2024-07-28T13:30:47.615000",
     "exception": false,
     "start_time": "2024-07-28T13:30:46.060515",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Furthermore 0.0\n",
      ", 2.0025988313921057e-14\n",
      "as 0.0\n",
      "an 0.0\n",
      "encouragement 0.0\n",
      "to 0.0\n",
      "revisionist 0.0\n",
      "thinking 0.0\n",
      ", 2.0025988313921057e-14\n",
      "it 0.0\n",
      "manifestly 0.0\n",
      "is 0.0\n",
      "fair 0.0\n",
      "to 0.0\n",
      "admit 0.0\n",
      "that 0.0\n",
      "any 0.0\n",
      "fraternity 0.0\n",
      "has 0.0\n",
      "a 0.0\n",
      "constitutional 0.0\n",
      "right 0.0\n",
      "to 0.0\n",
      "refuse 0.0\n",
      "to 0.0\n",
      "accept 0.0\n",
      "persons 0.0\n",
      "it 0.0\n",
      "dislikes 0.0\n",
      ". 0.0\n"
     ]
    }
   ],
   "source": [
    "# Examining the 1st example.\n",
    "x = dataset[0]\n",
    "am = tf.nn.softmax(model(tf.reshape(x[:-1], (1, sentence_length))), axis = -1)\n",
    "indices = map(int, x[1:])\n",
    "am = tf.reshape(am, (-1, vocab_size))\n",
    "probs = []\n",
    "for i, idx in enumerate(indices):\n",
    "    if idx == 0:\n",
    "        break\n",
    "    print(vocab[idx], float(am[i, idx]))\n",
    "    probs.append(float(am[i, idx]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "fcf9ccf3",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T13:30:50.398078Z",
     "iopub.status.busy": "2024-07-28T13:30:50.397645Z",
     "iopub.status.idle": "2024-07-28T13:36:32.513522Z",
     "shell.execute_reply": "2024-07-28T13:36:32.512270Z"
    },
    "papermill": {
     "duration": 343.480595,
     "end_time": "2024-07-28T13:36:32.515587",
     "exception": false,
     "start_time": "2024-07-28T13:30:49.034992",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Chinese .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Chinese .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Chinese .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Chinese .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n",
      ".Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface .Surface\n"
     ]
    }
   ],
   "source": [
    "def softmax(logits, axis = -1):\n",
    "    e = np.exp(logits)\n",
    "    return e/np.sum(e, axis = axis)\n",
    "\n",
    "def sample(n = 10, temperature = .7):\n",
    "    for _ in range(n):\n",
    "        x = np.zeros((sentence_length + 1)) \n",
    "        # The first token is <S> which is irrelevant to the output.\n",
    "        x[0] = 1 # I could've used one-hot but making a sentence with one-hot seems weird. \n",
    "        i = 0\n",
    "        choices = []\n",
    "        choice = 0\n",
    "        indices = list(range(vocab_size))\n",
    "        \n",
    "        while choice != point and i < sentence_length:\n",
    "            out = np.ravel(model(x[:-1].reshape(1, sentence_length))[0, i])\n",
    "            # output shape is (batch_size, sentence_length, vocab_size)\n",
    "            probs = softmax(out / temperature, axis = -1)\n",
    "            choice = np.random.choice(indices, p = probs)\n",
    "            i = i+1\n",
    "            x[i] = choice\n",
    "            choices.append(choice)\n",
    "\n",
    "        sample = \" \".join(map(lambda x : vocab[x], choices))\n",
    "        print(sample)\n",
    "\n",
    "sample(25)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "786cfee6",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-28T13:36:35.295804Z",
     "iopub.status.busy": "2024-07-28T13:36:35.295028Z",
     "iopub.status.idle": "2024-07-28T13:36:35.299437Z",
     "shell.execute_reply": "2024-07-28T13:36:35.298495Z"
    },
    "papermill": {
     "duration": 1.413311,
     "end_time": "2024-07-28T13:36:35.301421",
     "exception": false,
     "start_time": "2024-07-28T13:36:33.888110",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# model.save(\"GPT.keras\")"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "gpu",
   "dataSources": [
    {
     "datasetId": 2058,
     "sourceId": 131078,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30616,
   "isGpuEnabled": true,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.12"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 5648.161798,
   "end_time": "2024-07-28T13:36:40.107498",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-07-28T12:02:31.945700",
   "version": "2.4.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
