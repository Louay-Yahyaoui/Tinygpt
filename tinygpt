{
 "cells": [
  {
   "cell_type": "code",
   "execution_count": 1,
   "id": "e3832515",
   "metadata": {
    "_cell_guid": "b1076dfc-b9ad-4769-8c92-a6c4dae69d19",
    "_uuid": "8f2839f25d086af736a60e9eeb907d3b93b6e0e5",
    "execution": {
     "iopub.execute_input": "2024-07-29T13:23:03.064658Z",
     "iopub.status.busy": "2024-07-29T13:23:03.064303Z",
     "iopub.status.idle": "2024-07-29T13:23:15.182990Z",
     "shell.execute_reply": "2024-07-29T13:23:15.182165Z"
    },
    "papermill": {
     "duration": 12.128537,
     "end_time": "2024-07-29T13:23:15.185278",
     "exception": false,
     "start_time": "2024-07-29T13:23:03.056741",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stderr",
     "output_type": "stream",
     "text": [
      "/opt/conda/lib/python3.10/site-packages/scipy/__init__.py:146: UserWarning: A NumPy version >=1.16.5 and <1.23.0 is required for this version of SciPy (detected version 1.24.3\n",
      "  warnings.warn(f\"A NumPy version >={np_minversion} and <{np_maxversion}\"\n"
     ]
    }
   ],
   "source": [
    "import os\n",
    "import tensorflow as tf\n",
    "from tensorflow.keras.layers import Dense, MultiHeadAttention, Embedding, Add, Dropout, LayerNormalization\n",
    "from tensorflow.keras.optimizers import Adam\n",
    "import numpy as np\n",
    "import bisect\n",
    "import re\n",
    "import math\n",
    "import os"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "id": "991846f4",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T13:23:15.198976Z",
     "iopub.status.busy": "2024-07-29T13:23:15.198139Z",
     "iopub.status.idle": "2024-07-29T13:23:15.205162Z",
     "shell.execute_reply": "2024-07-29T13:23:15.204375Z"
    },
    "papermill": {
     "duration": 0.015566,
     "end_time": "2024-07-29T13:23:15.207039",
     "exception": false,
     "start_time": "2024-07-29T13:23:15.191473",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "'\\n# My tokenkization\\nfrom nltk.corpus import brown\\n\\nfor file in brown.fileids():\\n    clean_file = re.sub(r\\'/[^\\\\s]+\\', \\' \\', brown.raw(file))\\n    dataset += clean_file + \"\\n\" # Concatenate all the files together\\n\\ndataset = re.sub(r\\'\\\\s+\\', \\' \\', dataset)\\nlen(dataset) # Number of characters\\n'"
      ]
     },
     "execution_count": 2,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "\"\"\"\n",
    "# My tokenkization\n",
    "from nltk.corpus import brown\n",
    "\n",
    "for file in brown.fileids():\n",
    "    clean_file = re.sub(r'/[^\\s]+', ' ', brown.raw(file))\n",
    "    dataset += clean_file + \"\\n\" # Concatenate all the files together\n",
    "\n",
    "dataset = re.sub(r'\\s+', ' ', dataset)\n",
    "len(dataset) # Number of characters\n",
    "\"\"\""
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "id": "eb7dbbd5",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T13:23:15.219945Z",
     "iopub.status.busy": "2024-07-29T13:23:15.219654Z",
     "iopub.status.idle": "2024-07-29T13:23:16.726758Z",
     "shell.execute_reply": "2024-07-29T13:23:16.725928Z"
    },
    "papermill": {
     "duration": 1.516316,
     "end_time": "2024-07-29T13:23:16.729260",
     "exception": false,
     "start_time": "2024-07-29T13:23:15.212944",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "import pandas as pd\n",
    "dataset = \"\"\n",
    "\n",
    "texts = pd.read_csv('/kaggle/input/brown.csv')[\"tokenized_text\"]\n",
    "for text in texts:\n",
    "    dataset += text\n",
    "# Separate the punctuation from the words by a space\n",
    "dataset = re.sub('[^a-zA-Z0-9\\s]+', lambda x: x.group(0)[0] , dataset)    \n",
    "dataset = re.sub(r'\\s+', ' ', dataset)\n",
    "\n",
    "dataset = dataset.split()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "id": "7acee4af",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T13:23:16.744166Z",
     "iopub.status.busy": "2024-07-29T13:23:16.743550Z",
     "iopub.status.idle": "2024-07-29T13:23:16.862793Z",
     "shell.execute_reply": "2024-07-29T13:23:16.861925Z"
    },
    "papermill": {
     "duration": 0.130894,
     "end_time": "2024-07-29T13:23:16.866254",
     "exception": false,
     "start_time": "2024-07-29T13:23:16.735360",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "61264"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "vocab = sorted(set(dataset))\n",
    "vocab_size = len(vocab) + 2\n",
    "vocab_size"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "id": "50e1fe8e",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T13:23:16.897853Z",
     "iopub.status.busy": "2024-07-29T13:23:16.897196Z",
     "iopub.status.idle": "2024-07-29T13:23:17.427843Z",
     "shell.execute_reply": "2024-07-29T13:23:17.426946Z"
    },
    "papermill": {
     "duration": 0.539906,
     "end_time": "2024-07-29T13:23:17.429979",
     "exception": false,
     "start_time": "2024-07-29T13:23:16.890073",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "text/plain": [
       "830"
      ]
     },
     "execution_count": 5,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "sentences = \" \".join(dataset).split(\".\")\n",
    "sentences = [s.split() for s in sentences if len(s.split())>0]\n",
    "max_length = max([len(s) for s in sentences])\n",
    "max_length"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "id": "4946455c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T13:23:17.443503Z",
     "iopub.status.busy": "2024-07-29T13:23:17.443222Z",
     "iopub.status.idle": "2024-07-29T13:23:17.474853Z",
     "shell.execute_reply": "2024-07-29T13:23:17.473855Z"
    },
    "papermill": {
     "duration": 0.040462,
     "end_time": "2024-07-29T13:23:17.476691",
     "exception": false,
     "start_time": "2024-07-29T13:23:17.436229",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "19.899629529231046 15.372308871704446 118.66599999999744\n"
     ]
    }
   ],
   "source": [
    "lengths = [len(s) for s in sentences]\n",
    "print(np.mean(lengths), np.std(lengths), np.quantile(lengths, .999))\n",
    "\n",
    "# 1 in 1000 sentences exceed 128 so 128 it is."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "id": "1e8c1876",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T13:23:17.491552Z",
     "iopub.status.busy": "2024-07-29T13:23:17.491266Z",
     "iopub.status.idle": "2024-07-29T13:23:19.343666Z",
     "shell.execute_reply": "2024-07-29T13:23:19.342621Z"
    },
    "papermill": {
     "duration": 1.862795,
     "end_time": "2024-07-29T13:23:19.346337",
     "exception": false,
     "start_time": "2024-07-29T13:23:17.483542",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "sentence_length = 128 # 2 ** math.ceil(math.log2(max_length)) if we want to\n",
    "# include every sentence. But truncating 1 in 1000 for 8x memory saving seems\n",
    "# obvious.\n",
    "pad_id = 0\n",
    "start_id = 1\n",
    "\n",
    "point = bisect.bisect_left(vocab, '.') + 2\n",
    "dataset = np.zeros((len(sentences),  sentence_length + 1), dtype = np.float32) + pad_id\n",
    "\n",
    "for i, sentence in enumerate(sentences):\n",
    "    dataset[i, :min(len(sentence) + 2, sentence_length + 1)] = np.array([start_id] + [bisect.bisect_left(vocab, word) + 2 for word in sentence][:sentence_length - 1] + [point], dtype = np.float32)\n",
    "\n",
    "vocab = [\"<PAD>\", \"<S>\"] + vocab"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "id": "303c3b0a",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T13:23:19.360288Z",
     "iopub.status.busy": "2024-07-29T13:23:19.359970Z",
     "iopub.status.idle": "2024-07-29T13:23:19.365683Z",
     "shell.execute_reply": "2024-07-29T13:23:19.364670Z"
    },
    "papermill": {
     "duration": 0.015022,
     "end_time": "2024-07-29T13:23:19.367832",
     "exception": false,
     "start_time": "2024-07-29T13:23:19.352810",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class FeedForward(tf.keras.Model):\n",
    "    def __init__(self, emb_dim, units):\n",
    "        super().__init__()\n",
    "        self.dense1 = Dense(units, activation = \"relu\")\n",
    "        self.dense2 = Dense(emb_dim)\n",
    "        \n",
    "    def call(self, x):\n",
    "        x = self.dense1(x)\n",
    "        out = self.dense2(x)\n",
    "        return out"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 9,
   "id": "38bf7152",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T13:23:19.381359Z",
     "iopub.status.busy": "2024-07-29T13:23:19.381101Z",
     "iopub.status.idle": "2024-07-29T13:23:19.388509Z",
     "shell.execute_reply": "2024-07-29T13:23:19.387676Z"
    },
    "papermill": {
     "duration": 0.016236,
     "end_time": "2024-07-29T13:23:19.390425",
     "exception": false,
     "start_time": "2024-07-29T13:23:19.374189",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class Decoder(tf.keras.Model):\n",
    "    def __init__(self, n_heads = 8, emb_dim = 512, units = 2048, dropout = .1):\n",
    "        super().__init__()\n",
    "        self.mha = MultiHeadAttention(n_heads, emb_dim//n_heads)\n",
    "        self.dropout1 =  Dropout(dropout)\n",
    "        self.ln1 = LayerNormalization()\n",
    "        \n",
    "        self.ffn = FeedForward(emb_dim, units)\n",
    "        self.dropout2 =  Dropout(dropout)\n",
    "        self.ln2 = LayerNormalization()\n",
    "        \n",
    "    def call(self, x, training):\n",
    "        # Masked multi-head self-attention\n",
    "        # The mask for the padding is problematic to implement here and it's more \n",
    "        # convenient to mask the loss function and we just use the look-ahead mask here.\n",
    "        x1 = self.mha(x, x, x, use_causal_mask = True)\n",
    "        x1 = self.dropout1(x1, training = training)\n",
    "        x = self.ln1(x1 + x)\n",
    "        \n",
    "        x2 = self.ffn(x)\n",
    "        x2 = self.dropout2(x2, training = training)\n",
    "        x = self.ln2(x + x2)\n",
    "        \n",
    "        return x"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "id": "6545023c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T13:23:19.403627Z",
     "iopub.status.busy": "2024-07-29T13:23:19.403356Z",
     "iopub.status.idle": "2024-07-29T13:23:19.410586Z",
     "shell.execute_reply": "2024-07-29T13:23:19.409741Z"
    },
    "papermill": {
     "duration": 0.016024,
     "end_time": "2024-07-29T13:23:19.412487",
     "exception": false,
     "start_time": "2024-07-29T13:23:19.396463",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class Transformer(tf.keras.Model):\n",
    "    def __init__(self, vocab_size, sentence_length = 256, n = 6, n_heads = 8, emb_dim = 512, units = 2048, dropout = .1):\n",
    "        super().__init__()\n",
    "        # Embedding layer\n",
    "        self.embedding = Embedding(vocab_size, emb_dim, input_length = sentence_length)\n",
    "        # Positional encoding\n",
    "        self.pos_encode = Add()\n",
    "        self.decoder_stack = [Decoder(n_heads, emb_dim, units, dropout) for _ in range(n)]\n",
    "        self.linear = Dense(vocab_size, activation = tf.nn.log_softmax)\n",
    "        \n",
    "    def call(self, x, training):\n",
    "        \n",
    "        x = self.embedding(x)\n",
    "        x = self.pos_encode([x, pos_encoding])\n",
    "        \n",
    "        for decoder in self.decoder_stack:\n",
    "            x = decoder(x, training)\n",
    "        \n",
    "        out = self.linear(x)\n",
    "        \n",
    "        return out"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "id": "f755c4c2",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T13:23:19.425858Z",
     "iopub.status.busy": "2024-07-29T13:23:19.425550Z",
     "iopub.status.idle": "2024-07-29T13:23:19.431708Z",
     "shell.execute_reply": "2024-07-29T13:23:19.430897Z"
    },
    "papermill": {
     "duration": 0.01518,
     "end_time": "2024-07-29T13:23:19.433693",
     "exception": false,
     "start_time": "2024-07-29T13:23:19.418513",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# For a generative model, label smoothing simply hurts perplexity which is what we care \n",
    "# about most. \n",
    "epsilon  = 0.0 # 0.1\n",
    "\n",
    "def masked_loss(label, pred, pad_id = 0):\n",
    "    mask = label != pad_id\n",
    "    \n",
    "    y = tf.one_hot(tf.cast(label, tf.int32), vocab_size, axis = -1)\n",
    "    loss_object = tf.keras.losses.CategoricalCrossentropy(\n",
    "    from_logits=True, reduction='none', label_smoothing = epsilon)\n",
    "    loss = loss_object(y, pred)\n",
    "    \n",
    "    mask = tf.cast(mask, dtype=loss.dtype)\n",
    "    loss *= mask\n",
    "\n",
    "    loss = tf.reduce_sum(loss)/tf.reduce_sum(mask)\n",
    "    return loss"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 12,
   "id": "d672e7d7",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T13:23:19.447823Z",
     "iopub.status.busy": "2024-07-29T13:23:19.447560Z",
     "iopub.status.idle": "2024-07-29T13:23:19.455011Z",
     "shell.execute_reply": "2024-07-29T13:23:19.454217Z"
    },
    "papermill": {
     "duration": 0.016115,
     "end_time": "2024-07-29T13:23:19.456792",
     "exception": false,
     "start_time": "2024-07-29T13:23:19.440677",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "class TransformerLearningRateSchedule(tf.keras.optimizers.schedules.LearningRateSchedule):\n",
    "    def __init__(self, initial_learning_rate, warmup_steps, dtype=tf.float32):\n",
    "        super(TransformerLearningRateSchedule, self).__init__()\n",
    "        self.initial_learning_rate = initial_learning_rate\n",
    "        self.dtype = dtype\n",
    "        self.warmup_steps = tf.cast(warmup_steps, self.dtype)\n",
    "\n",
    "    def __call__(self, step):\n",
    "        step = tf.cast(step, self.dtype)\n",
    "        warmup_steps = tf.cast(self.warmup_steps, self.dtype)\n",
    "        x1 = tf.math.pow(step, tf.constant(-0.5, dtype = self.dtype))\n",
    "        x2 = step * tf.math.pow(self.warmup_steps, tf.constant(-1.5, dtype = self.dtype))\n",
    "        return self.initial_learning_rate * tf.math.minimum(x1, x2)\n",
    "\n",
    "    def get_config(self):\n",
    "        return {\n",
    "            'initial_learning_rate': self.initial_learning_rate,\n",
    "            'warmup_steps': self.warmup_steps,\n",
    "            'dtype': self.dtype\n",
    "        }"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 13,
   "id": "367f1c37",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T13:23:19.470073Z",
     "iopub.status.busy": "2024-07-29T13:23:19.469595Z",
     "iopub.status.idle": "2024-07-29T13:23:20.362522Z",
     "shell.execute_reply": "2024-07-29T13:23:20.361524Z"
    },
    "papermill": {
     "duration": 0.90207,
     "end_time": "2024-07-29T13:23:20.364930",
     "exception": false,
     "start_time": "2024-07-29T13:23:19.462860",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "emb_dim = 512\n",
    "n_heads = 8\n",
    "units = 2048\n",
    "n = 3 # 6\n",
    "dropout = 0.1 # 0.1\n",
    "warmup_steps = 4000\n",
    "#learning_rate = 1e-4\n",
    "# Using a different learning rate than the paper as they train for many more steps.\n",
    "learning_rate_schedule = TransformerLearningRateSchedule(emb_dim**-.5, warmup_steps)\n",
    "optimizer = Adam(learning_rate_schedule, beta_1 = .9, beta_2 = .998, epsilon = 1e-9)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "id": "c925ed13",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T13:23:20.379269Z",
     "iopub.status.busy": "2024-07-29T13:23:20.378754Z",
     "iopub.status.idle": "2024-07-29T13:23:20.390156Z",
     "shell.execute_reply": "2024-07-29T13:23:20.389323Z"
    },
    "papermill": {
     "duration": 0.02062,
     "end_time": "2024-07-29T13:23:20.392197",
     "exception": false,
     "start_time": "2024-07-29T13:23:20.371577",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# Positional encoding\n",
    "pos_encoding = np.zeros((sentence_length, emb_dim))\n",
    "pos = np.arange(sentence_length)[:, np.newaxis]\n",
    "even = np.arange(emb_dim, step = 2)[np.newaxis, :]\n",
    "pos_encoding[:, ::2] = np.sin(pos/10**(4*even/emb_dim))\n",
    "pos_encoding[:, 1::2] = np.cos(pos/10**(4*even/emb_dim))\n",
    "pos_encoding = pos_encoding[np.newaxis, :, :] # Adding the batch dimension\n",
    "pos_encoding = tf.cast(pos_encoding, dtype=tf.float32)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 15,
   "id": "7b238266",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T13:23:20.405561Z",
     "iopub.status.busy": "2024-07-29T13:23:20.405295Z",
     "iopub.status.idle": "2024-07-29T13:23:21.105555Z",
     "shell.execute_reply": "2024-07-29T13:23:21.104618Z"
    },
    "papermill": {
     "duration": 0.709093,
     "end_time": "2024-07-29T13:23:21.107509",
     "exception": false,
     "start_time": "2024-07-29T13:23:20.398416",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Model: \"transformer\"\n",
      "_________________________________________________________________\n",
      " Layer (type)                Output Shape              Param #   \n",
      "=================================================================\n",
      " embedding (Embedding)       multiple                  31367168  \n",
      "                                                                 \n",
      " add (Add)                   multiple                  0         \n",
      "                                                                 \n",
      " decoder (Decoder)           multiple                  3152384   \n",
      "                                                                 \n",
      " decoder_1 (Decoder)         multiple                  3152384   \n",
      "                                                                 \n",
      " decoder_2 (Decoder)         multiple                  3152384   \n",
      "                                                                 \n",
      " dense_6 (Dense)             multiple                  31428432  \n",
      "                                                                 \n",
      "=================================================================\n",
      "Total params: 72252752 (275.62 MB)\n",
      "Trainable params: 72252752 (275.62 MB)\n",
      "Non-trainable params: 0 (0.00 Byte)\n",
      "_________________________________________________________________\n"
     ]
    }
   ],
   "source": [
    "model = Transformer(vocab_size, sentence_length, n, n_heads, emb_dim, units, dropout)\n",
    "model.compile(optimizer, masked_loss)\n",
    "model.build((None, sentence_length))\n",
    "\n",
    "model.summary()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 16,
   "id": "dbeee950",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T13:23:21.124523Z",
     "iopub.status.busy": "2024-07-29T13:23:21.124231Z",
     "iopub.status.idle": "2024-07-29T14:33:47.798448Z",
     "shell.execute_reply": "2024-07-29T14:33:47.797391Z"
    },
    "papermill": {
     "duration": 4226.685157,
     "end_time": "2024-07-29T14:33:47.800758",
     "exception": false,
     "start_time": "2024-07-29T13:23:21.115601",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Epoch 1/10\n",
      "1643/1643 [==============================] - 431s 256ms/step - loss: 7.3570 - val_loss: 6.5373\n",
      "Epoch 2/10\n",
      "1643/1643 [==============================] - 419s 255ms/step - loss: 6.1928 - val_loss: 6.3618\n",
      "Epoch 3/10\n",
      "1643/1643 [==============================] - 419s 255ms/step - loss: 5.8787 - val_loss: 6.2803\n",
      "Epoch 4/10\n",
      "1643/1643 [==============================] - 419s 255ms/step - loss: 5.5270 - val_loss: 6.2526\n",
      "Epoch 5/10\n",
      "1643/1643 [==============================] - 419s 255ms/step - loss: 5.1982 - val_loss: 6.3279\n",
      "Epoch 6/10\n",
      "1643/1643 [==============================] - 419s 255ms/step - loss: 4.8832 - val_loss: 6.4417\n",
      "Epoch 7/10\n",
      "1643/1643 [==============================] - 419s 255ms/step - loss: 4.5742 - val_loss: 6.5866\n",
      "Epoch 8/10\n",
      "1643/1643 [==============================] - 419s 255ms/step - loss: 4.2791 - val_loss: 6.7410\n",
      "Epoch 9/10\n",
      "1643/1643 [==============================] - 419s 255ms/step - loss: 4.0101 - val_loss: 6.9015\n",
      "Epoch 10/10\n",
      "1643/1643 [==============================] - 419s 255ms/step - loss: 3.7736 - val_loss: 7.0714\n"
     ]
    }
   ],
   "source": [
    "batch_size = 32\n",
    "epochs = 10\n",
    "\n",
    "# X is simply the expected output shifted to the right with a <S> token at the beginning.\n",
    "history = model.fit(dataset[:, :-1], dataset[:, 1:], batch_size, epochs, validation_split = .05)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 17,
   "id": "ba1b19ea",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T14:33:50.464583Z",
     "iopub.status.busy": "2024-07-29T14:33:50.464235Z",
     "iopub.status.idle": "2024-07-29T14:33:50.850679Z",
     "shell.execute_reply": "2024-07-29T14:33:50.849769Z"
    },
    "papermill": {
     "duration": 1.685243,
     "end_time": "2024-07-29T14:33:50.852638",
     "exception": false,
     "start_time": "2024-07-29T14:33:49.167395",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "data": {
      "image/png": "iVBORw0KGgoAAAANSUhEUgAAAnYAAAHWCAYAAAD6oMSKAAAAOXRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjcuNCwgaHR0cHM6Ly9tYXRwbG90bGliLm9yZy8WgzjOAAAACXBIWXMAAA9hAAAPYQGoP6dpAABiyklEQVR4nO3deZyNdf/H8dc5s+/GMDOWicHM2KUGN9NCdlLJUpYQ1V0pofqVuisSUil3uSkSbVSyJJGttEihUsmefZmxz2KY7Vy/Py4zmuzjzFznnHk/H4/rUdd1ruuczzHk3Xe1GYZhICIiIiJuz251ASIiIiLiHAp2IiIiIh5CwU5ERETEQyjYiYiIiHgIBTsRERERD6FgJyIiIuIhFOxEREREPISCnYiIiIiHULATERER8RAKdiIi52Cz2Rg+fPhlP7dz505sNhvTp093ek0iIhejYCciLmv69OnYbDZsNhvff//9Wa8bhkFMTAw2m42bb77ZggqLbsWKFdhsNj799FOrSxERD6JgJyIuz9/fnxkzZpx1/ZtvvmHv3r34+flZUJWIiOtRsBMRl9ehQwdmzZpFbm5uoeszZszg2muvJTo62qLKRERci4KdiLi8Hj16cOTIEZYuXVpwLTs7m08//ZSePXue85kTJ07w6KOPEhMTg5+fHwkJCbzyyisYhlHovqysLIYMGUL58uUJCQnhlltuYe/eved8z3379tG/f3+ioqLw8/OjTp06vPPOO877ouewfft2unXrRtmyZQkMDORf//oXX3zxxVn3vfHGG9SpU4fAwEDCw8NJTEws1MqZnp7O4MGDqVq1Kn5+fkRGRtK6dWt++eWXYq1fREqWgp2IuLyqVavStGlTZs6cWXBt0aJFpKamcuedd551v2EY3HLLLbz22mu0a9eOV199lYSEBB5//HGGDh1a6N577rmH8ePH06ZNG1588UV8fHzo2LHjWe+ZkpLCv/71L5YtW8ZDDz3Ef//7X2rUqMGAAQMYP368079z/mc2a9aMxYsX8+CDDzJq1ChOnTrFLbfcwty5cwvumzJlCoMGDaJ27dqMHz+eESNGcPXVV/PTTz8V3HP//fczadIkunTpwsSJE3nssccICAhg48aNxVK7iFjEEBFxUdOmTTMAY82aNcaECROMkJAQIzMz0zAMw+jWrZvRokULwzAMo0qVKkbHjh0Lnps3b54BGC+88EKh9+vataths9mMbdu2GYZhGOvWrTMA48EHHyx0X8+ePQ3AeO655wquDRgwwKhQoYJx+PDhQvfeeeedRlhYWEFdO3bsMABj2rRpF/xuX3/9tQEYs2bNOu89gwcPNgDju+++K7iWnp5uxMbGGlWrVjXy8vIMwzCMW2+91ahTp84FPy8sLMwYOHDgBe8REfenFjsRcQvdu3fn5MmTLFiwgPT0dBYsWHDebtiFCxfi5eXFoEGDCl1/9NFHMQyDRYsWFdwHnHXf4MGDC50bhsHs2bPp1KkThmFw+PDhgqNt27akpqYWS5fmwoULady4Mdddd13BteDgYO677z527tzJhg0bAChTpgx79+5lzZo1532vMmXK8NNPP7F//36n1ykirkPBTkTcQvny5WnVqhUzZsxgzpw55OXl0bVr13Peu2vXLipWrEhISEih67Vq1Sp4Pf+fdrud6tWrF7ovISGh0PmhQ4c4fvw4kydPpnz58oWOu+++G4CDBw865Xv+83v8s5ZzfY8nnniC4OBgGjduTFxcHAMHDmTlypWFnnnppZdYv349MTExNG7cmOHDh7N9+3an1ywi1vK2ugARkUvVs2dP7r33XpKTk2nfvj1lypQpkc91OBwA9O7dm759+57znvr165dILedSq1YtNm/ezIIFC/jyyy+ZPXs2EydO5Nlnn2XEiBGA2eJ5/fXXM3fuXJYsWcLLL7/M2LFjmTNnDu3bt7esdhFxLrXYiYjb6Ny5M3a7nR9//PG83bAAVapUYf/+/aSnpxe6vmnTpoLX8//pcDj466+/Ct23efPmQuf5M2bz8vJo1arVOY/IyEhnfMWzvsc/aznX9wAICgrijjvuYNq0aezevZuOHTsWTLbIV6FCBR588EHmzZvHjh07iIiIYNSoUU6vW0Sso2AnIm4jODiYSZMmMXz4cDp16nTe+zp06EBeXh4TJkwodP21117DZrMVtFDl//P1118vdN8/Z7l6eXnRpUsXZs+ezfr168/6vEOHDhXl61xUhw4dWL16NatWrSq4duLECSZPnkzVqlWpXbs2AEeOHCn0nK+vL7Vr18YwDHJycsjLyyM1NbXQPZGRkVSsWJGsrKxiqV1ErKGuWBFxK+frCv27Tp060aJFC55++ml27txJgwYNWLJkCZ999hmDBw8uGFN39dVX06NHDyZOnEhqairN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JpeoU6dOjBo1iquuuoo6derw66+/8uqrr9K/f3+rS/N4Wu6kGEyYMIGXX36Z5ORkrr76al5//XWaNGlidVlyCWw22zmvT5s2jX79+pVsMeI0zZs313InbmbBggUMGzaMrVu3Ehsby9ChQ7n33nutLksuUXp6Os888wxz587l4MGDVKxYkR49evDss8/i6+trdXkeTcFORERExENojJ2IiIiIh1CwExEREfEQCnYiIiIiHkLBTkRERMRDKNiJiIiIeAgFOxEREREPoWAnIiIi4iEU7EREREQ8hIKdiIjFbDYb8+bNs7oMEfEACnYiUqr169cPm8121tGuXTurSxMRuWzeVhcgImK1du3aMW3atELX/Pz8LKpGRKTo1GInIqWen58f0dHRhY7w8HDA7CadNGkS7du3JyAggGrVqvHpp58Wev6PP/7gpptuIiAggIiICO677z4yMjIK3fPOO+9Qp04d/Pz8qFChAg899FCh1w8fPkznzp0JDAwkLi6O+fPnF++XFhGPpGAnInIRzzzzDF26dOG3336jV69e3HnnnWzcuBGAEydO0LZtW8LDw1mzZg2zZs1i2bJlhYLbpEmTGDhwIPfddx9//PEH8+fPp0aNGoU+Y8SIEXTv3p3ff/+dDh060KtXL44ePVqi31NEPIAhIlKK9e3b1/Dy8jKCgoIKHaNGjTIMwzAA4/777y/0TJMmTYwHHnjAMAzDmDx5shEeHm5kZGQUvP7FF18YdrvdSE5ONgzDMCpWrGg8/fTT560BMP7zn/8UnGdkZBiAsWjRIqd9TxEpHTTGTkRKvRYtWjBp0qRC18qWLVvw702bNi30WtOmTVm3bh0AGzdupEGDBgQFBRW8npSUhMPhYPPmzdhsNvbv30/Lli0vWEP9+vUL/j0oKIjQ0FAOHjxY1K8kIqWUgp2IlHpBQUFndY06S0BAwCXd5+PjU+jcZrPhcDiKoyQR8WAaYycichE//vjjWee1atUCoFatWvz222+cOHGi4PWVK1dit9tJSEggJCSEqlWrsnz58hKtWURKJ7XYiUipl5WVRXJycqFr3t7elCtXDoBZs2aRmJjIddddx4cffsjq1auZOnUqAL169eK5556jb9++DB8+nEOHDvHwww9z1113ERUVBcDw4cO5//77iYyMpH379qSnp7Ny5Uoefvjhkv2iIuLxFOxEpNT78ssvqVChQqFrCQkJbNq0CTBnrH700Uc8+OCDVKhQgZkzZ1K7dm0AAgMDWbx4MY888giNGjUiMDCQLl268Oqrrxa8V9++fTl16hSvvfYajz32GOXKlaNr164l9wVFpNSwGYZhWF2EiIirstlszJ07l9tuu83qUkRELkpj7EREREQ8hIKdiIiIiIfQGDsRkQvQaBURcSdqsRMRERHxEAp2IiIiIh5CwU5ERETEQyjYiYiIiHgIBTsRERERD6FgJyIiIuIhFOxEREREPISCnYiIiIiHULATERER8RD/DwWBHNWtHschAAAAAElFTkSuQmCC",
      "text/plain": [
       "<Figure size 640x480 with 1 Axes>"
      ]
     },
     "metadata": {},
     "output_type": "display_data"
    }
   ],
   "source": [
    "import matplotlib.pyplot as plt\n",
    "\n",
    "plt.plot(history.history['loss'], label='Train Loss')\n",
    "plt.plot(history.history['val_loss'], label='Val Loss')\n",
    "plt.title('Model Loss')\n",
    "plt.xlabel('Epoch')\n",
    "plt.ylabel('Loss')\n",
    "plt.legend(loc='upper right')\n",
    "plt.ylim(6, max(history.history['loss'] + history.history['val_loss']))\n",
    "plt.tight_layout()\n",
    "plt.show()"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "id": "f5b01e22",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T14:33:53.523044Z",
     "iopub.status.busy": "2024-07-29T14:33:53.522663Z",
     "iopub.status.idle": "2024-07-29T14:33:53.650404Z",
     "shell.execute_reply": "2024-07-29T14:33:53.649331Z"
    },
    "papermill": {
     "duration": 1.425323,
     "end_time": "2024-07-29T14:33:53.652519",
     "exception": false,
     "start_time": "2024-07-29T14:33:52.227196",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Furthermore 0.0014137453399598598\n",
      ", 0.8913167715072632\n",
      "as 0.0230296328663826\n",
      "an 0.032610490918159485\n",
      "encouragement 0.02528342977166176\n",
      "to 0.19618120789527893\n",
      "revisionist 0.9682667255401611\n",
      "thinking 0.06112002581357956\n",
      ", 0.41338667273521423\n",
      "it 0.1678258776664734\n",
      "manifestly 0.08056072890758514\n",
      "is 0.030743444338440895\n",
      "fair 0.0051047541201114655\n",
      "to 0.667154848575592\n",
      "admit 0.003469702787697315\n",
      "that 0.23524460196495056\n",
      "any 0.021341685205698013\n",
      "fraternity 0.08341308683156967\n",
      "has 0.09453856945037842\n",
      "a 0.08539324253797531\n",
      "constitutional 0.004216093569993973\n",
      "right 0.00015429608174599707\n",
      "to 0.7784053087234497\n",
      "refuse 0.00523311598226428\n",
      "to 0.4155159592628479\n",
      "accept 0.03979784995317459\n",
      "persons 0.0013726619072258472\n",
      "it 0.00013153263716958463\n",
      "dislikes 0.5145654678344727\n",
      ". 0.664555549621582\n"
     ]
    }
   ],
   "source": [
    "# Examining the 1st example.\n",
    "x = dataset[0]\n",
    "am = tf.nn.softmax(model(tf.reshape(x[:-1], (1, sentence_length))), axis = -1)\n",
    "indices = map(int, x[1:])\n",
    "am = tf.reshape(am, (-1, vocab_size))\n",
    "probs = []\n",
    "for i, idx in enumerate(indices):\n",
    "    if idx == 0:\n",
    "        break\n",
    "    print(vocab[idx], float(am[i, idx]))\n",
    "    probs.append(float(am[i, idx]))"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 19,
   "id": "ddf4144c",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T14:33:56.322433Z",
     "iopub.status.busy": "2024-07-29T14:33:56.321709Z",
     "iopub.status.idle": "2024-07-29T14:34:27.246382Z",
     "shell.execute_reply": "2024-07-29T14:34:27.245257Z"
    },
    "papermill": {
     "duration": 33.635136,
     "end_time": "2024-07-29T14:34:28.656558",
     "exception": false,
     "start_time": "2024-07-29T14:33:55.021422",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Peal birds are not to be found in a manner .\n",
      "It is at first that the lack of matter is based on the race and has been for the same format of the practice of the state , but that the Fellows is a marked sum of the community .\n",
      "What about your country ' ? ?She inquired .\n",
      "And the one will have been in this area if it is a matter of fact ' .\n",
      "I had to call the lights of the hotel , and I were still a Democrat .\n",
      "In a voice in London , the developers were huddled in the Congo and as a writer of criminality in Switzerland ; ;this is designed to do a to say that one is to be the only man , the reasons for his wife .\n",
      "For example , about Af is only represented by a transformed plane .\n",
      "The same purpose of the East is itself new .\n",
      "I think I really can look at them , but I am not so much like a pristine and honest , but not forget that I am not inclined to know the future of my good friends , but that the tendency to paie ' .\n",
      "You can be sure , Dad .\n",
      "In testimony whereof , I have hereunto set my hand into the winds of my company , the best to my company , the more subtle element of our country , the less extensive religions that would be far to be the only effective , or the most spacious perfumed on the occasion .\n",
      "It is another project in the midst of a large discrepancy on the central three decades and that the industry is uncertain , of a total increase in wage rate and the basic wage rate of wage rates on the same end of the wage rate .\n",
      "The other , H factor in which the null space was Af .\n",
      "The first sample by which the gyro is valid and reorganized in an isolated position .\n",
      "He will depend on the office of the evening , and perhaps , one has been the same element .\n",
      "Thus , the basic approach utilized to absorb properties , the only function of the solar System is Af .\n",
      "The most unusual losses of the apparatus was established to the chemical danger of the radical century and the solution of the state of the Belgians .\n",
      "It was only the first time of life .\n",
      "Two years older than Mitch Barton is heard , his wife , who is not holding his horse in bed .\n",
      "The next night , the next day the envelope had come in a fusion ship .\n",
      "He said , ` Let you look for him .\n",
      "No other visitor , was surprised for a note that the door should be lame and identified a criminality in the air .\n",
      "Perhaps , as it is Johnson , the Colonel and one private band , who is still the most reluctant to put a success of orbit and defeat .\n",
      "The simple , cawing hunt of today , is the highest job .\n",
      "The lock is a null-type instrument and the heat of a disk range of an error consisting of an error velocity to form a method .\n"
     ]
    }
   ],
   "source": [
    "def softmax(logits, axis = -1):\n",
    "    e = np.exp(logits)\n",
    "    return e/np.sum(e, axis = axis)\n",
    "\n",
    "def sample(n = 10, temperature = .7):\n",
    "    for _ in range(n):\n",
    "        x = np.zeros((sentence_length + 1)) \n",
    "        # The first token is <S> which is irrelevant to the output.\n",
    "        x[0] = 1 # I could've used one-hot but making a sentence with one-hot seems weird. \n",
    "        i = 0\n",
    "        choices = []\n",
    "        choice = 0\n",
    "        indices = list(range(vocab_size))\n",
    "        \n",
    "        while choice != point and i < sentence_length:\n",
    "            out = np.ravel(model(x[:-1].reshape(1, sentence_length))[0, i])\n",
    "            # output shape is (batch_size, sentence_length, vocab_size)\n",
    "            probs = softmax(out / temperature, axis = -1)\n",
    "            choice = np.random.choice(indices, p = probs)\n",
    "            i = i+1\n",
    "            x[i] = choice\n",
    "            choices.append(choice)\n",
    "\n",
    "        sample = \" \".join(map(lambda x : vocab[x], choices))\n",
    "        print(sample)\n",
    "\n",
    "sample(25)"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 20,
   "id": "7ebd63ad",
   "metadata": {
    "execution": {
     "iopub.execute_input": "2024-07-29T14:34:31.383382Z",
     "iopub.status.busy": "2024-07-29T14:34:31.382517Z",
     "iopub.status.idle": "2024-07-29T14:34:31.386802Z",
     "shell.execute_reply": "2024-07-29T14:34:31.385970Z"
    },
    "papermill": {
     "duration": 1.410017,
     "end_time": "2024-07-29T14:34:31.388647",
     "exception": false,
     "start_time": "2024-07-29T14:34:29.978630",
     "status": "completed"
    },
    "tags": []
   },
   "outputs": [],
   "source": [
    "# model.save(\"GPT.keras\")"
   ]
  }
 ],
 "metadata": {
  "kaggle": {
   "accelerator": "gpu",
   "dataSources": [
    {
     "datasetId": 2058,
     "sourceId": 131078,
     "sourceType": "datasetVersion"
    }
   ],
   "dockerImageVersionId": 30616,
   "isGpuEnabled": true,
   "isInternetEnabled": true,
   "language": "python",
   "sourceType": "notebook"
  },
  "kernelspec": {
   "display_name": "Python 3",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.10.12"
  },
  "papermill": {
   "default_parameters": {},
   "duration": 4295.787606,
   "end_time": "2024-07-29T14:34:35.444218",
   "environment_variables": {},
   "exception": null,
   "input_path": "__notebook__.ipynb",
   "output_path": "__notebook__.ipynb",
   "parameters": {},
   "start_time": "2024-07-29T13:22:59.656612",
   "version": "2.4.0"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 5
}
